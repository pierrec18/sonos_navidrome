# Configuration NGINX pour le streaming audio avec support des Range requests
# À ajouter dans NPM (Nginx Proxy Manager) - onglet Advanced du Proxy Host musique.crvsk.me

# Laisse passer les requêtes de plage pour le streaming audio
proxy_set_header Range $http_range;
proxy_set_header If-Range $http_if_range;

# Force le support des ranges si Accept-Ranges absent
proxy_force_ranges on;

# Streaming / seek plus fiable - désactive le buffering
proxy_request_buffering off;
proxy_buffering off;
proxy_http_version 1.1;

# Optionnel: annoncer le support des ranges
add_header Accept-Ranges bytes always;

# Headers pour le streaming optimisé
proxy_set_header Connection "";
proxy_set_header X-Real-IP $remote_addr;
proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
proxy_set_header X-Forwarded-Proto $scheme;
proxy_set_header Host $http_host;

# Timeouts adaptés au streaming
proxy_connect_timeout 60s;
proxy_send_timeout 300s;
proxy_read_timeout 300s;

# Cache désactivé pour les streams
proxy_cache off;
